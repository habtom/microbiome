<html>
	<head>

	</head>
	<body>
  		<div id="chartStage"></div>
  		<div id="chartStacked"></div>
  		<div id="chartPie"></div>
  		<div id="mDisorder"></div>
  		<script src="http://d3js.org/d3.v3.min.js"></script>
		<script src="http://dimplejs.org/dist/dimple.v2.1.2.min.js"></script>
		<script type="text/javascript">

			var JSON_LC3Distribution = {

							"cytoplasm": 	{"dataset2_percentage":"83.1","dataset1_percentage":"88.2","reference_percentage":"52.7"},
							"outer":        {"dataset2_percentage":"1.9","dataset1_percentage":"1.8","reference_percentage":"1.7"},
							"fimbrium": 	{"dataset2_percentage":"0.1","dataset1_percentage":"0.3","reference_percentage":"0.6"},
							"periplasm": 	{"dataset2_percentage":"6.2","dataset1_percentage":"4.3","reference_percentage":"3.8"},
							"secreted": 	{"dataset2_percentage":"5.0","dataset1_percentage":"3.8","reference_percentage":"22.2"},
							"inner": 		{"dataset2_percentage":"3.7","dataset1_percentage":"1.5","reference_percentage":"18.9"}

						}

			var JSON_LC3distributionRI = {

							"cytoplasm": {"dataset1_41_80_percentage":"27.6","dataset2_81_100_percentage":"33.6","dataset1_81_100_percentage":"37.2","reference_0_40_percentage":"14.5","dataset2_41_80_percentage":"23.9","dataset1_0_40_percentage":"23.3","reference_81_100_percentage":"27.3","dataset2_0_40_percentage":"25.6","reference_41_80_percentage":"10.9"},
							"outer":     {"dataset1_41_80_percentage":null,"dataset2_81_100_percentage":null,"dataset1_81_100_percentage":null,"reference_0_40_percentage":null,"dataset2_41_80_percentage":null,"dataset1_0_40_percentage":null,"reference_81_100_percentage":null,"dataset2_0_40_percentage":null,"reference_41_80_percentage":null},
							"fimbrium":  {"dataset1_41_80_percentage":"0.1","dataset2_81_100_percentage":"0.6","dataset1_81_100_percentage":"0.3","reference_0_40_percentage":"9.2","dataset2_41_80_percentage":"0.1","dataset1_0_40_percentage":"1.0","reference_81_100_percentage":"7.7","dataset2_0_40_percentage":"3.0","reference_41_80_percentage":"2.0"},
							"periplasm": {"dataset1_41_80_percentage":null,"dataset2_81_100_percentage":null,"dataset1_81_100_percentage":null,"reference_0_40_percentage":null,"dataset2_41_80_percentage":null,"dataset1_0_40_percentage":null,"reference_81_100_percentage":null,"dataset2_0_40_percentage":null,"reference_41_80_percentage":null},
							"secreted":  {"dataset1_41_80_percentage":null,"dataset2_81_100_percentage":null,"dataset1_81_100_percentage":null,"reference_0_40_percentage":null,"dataset2_41_80_percentage":null,"dataset1_0_40_percentage":null,"reference_81_100_percentage":null,"dataset2_0_40_percentage":null,"reference_41_80_percentage":null},
							"inner":     {"dataset1_41_80_percentage":"0.9","dataset2_81_100_percentage":"0.6","dataset1_81_100_percentage":"0.7","reference_0_40_percentage":"2.8","dataset2_41_80_percentage":"0.8","dataset1_0_40_percentage":"2.7","reference_81_100_percentage":"0.3","dataset2_0_40_percentage":"4.9","reference_41_80_percentage":"0.7"}

						}

			var	JSON_TMSEG_distribution = {

						  "Transmembrane proteins": {"dataset2_sequences":"109","reference_sequences":"28359","dataset1_sequences":"55"},
						  "Signaling proteins":		{"dataset2_sequences":" 166","reference_sequences":" 19600","dataset1_sequences":" 120"},
						  "No prediction": 			{"dataset2_sequences":" 2208","reference_sequences":" 89058","dataset1_sequences":" 2228"}

						}
			var JSON_MDISORDER_disordered_30 = {

						"6":{"dataset2_sequences":"1","reference_sequences":"21","dataset1_sequences":0},
						"1":{"dataset2_sequences":"230","reference_sequences":"22913","dataset1_sequences":"293"},
						"4":{"dataset2_sequences":"1","reference_sequences":"75","dataset1_sequences":0},
						"0":{"dataset2_sequences":"2204","reference_sequences":"110035","dataset1_sequences":"2035"},
						"3":{"dataset2_sequences":"2","reference_sequences":"437","dataset1_sequences":"3"},
						"2":{"dataset2_sequences":"44","reference_sequences":"3502","dataset1_sequences":"72"}

						}

		    var JSON_MDISORDER_ordered_50 = {

						"6":{"dataset2_sequences":"7","reference_sequences":"189","dataset1_sequences":"2"},
						"3":{"dataset2_sequences":"100","reference_sequences":"5257","dataset1_sequences":"68"},
						"7":{"dataset2_sequences":"1","reference_sequences":"69","dataset1_sequences":"3"},
						"2":{"dataset2_sequences":"427","reference_sequences":"20893","dataset1_sequences":"376"},
						"8":{"dataset2_sequences":"0","reference_sequences":"40","dataset1_sequences":"1"},
						"1":{"dataset2_sequences":"1629","reference_sequences":"66614","dataset1_sequences":"1400"},
						"4":{"dataset2_sequences":"21","reference_sequences":"1550","dataset1_sequences":"17"},
						"0":{"dataset2_sequences":"282","reference_sequences":"41792","dataset1_sequences":"533"},
						"5":{"dataset2_sequences":"15","reference_sequences":"550","dataset1_sequences":"3"}
				
					}			


			var JSON_MDISORDER_disordered_80 = {

						"1":{"dataset2_sequences":"54","reference_sequences":"3831","dataset1_sequences":"36"},
						"0":{"dataset2_sequences":"2427","reference_sequences":"133050","dataset1_sequences":"2367"},
						"2":{"dataset2_sequences":"1","reference_sequences":"118","dataset1_sequences":100000}

					}



		handler("pie",JSON_TMSEG_distribution);
		handler("disorder",JSON_MDISORDER_disordered_80);	
		handler("doubleBar",JSON_LC3Distribution);
		handler("stackedBar",JSON_LC3distributionRI);

		function handler (type,data){
			if(type == "doubleBar"){

				doubleBarDrawing(data);
			}
			else if(type == "stackedBar"){

				stackedBarDrawing(data);
			}
			else if(type == "pie"){

				pieBarDrawing(data);
			}
			else if(type == "disorder"){

				Disorder(data);
			}

		}


		function doubleBarDrawing(data){
			
			var DoublebarChartData = [];

			for (var obj in data){

					DoublebarChartData.push({

						"Localization": obj,
						"Sequence frequency": data[obj]["reference_percentage"],
						"Sequences": "Reference"
						//"count": "Reference"
						

					})
					DoublebarChartData.push({

						"Localization": obj,
						"Sequence frequency": data[obj]["dataset1_percentage"],
						"Sequences": "Dataset 1"
						//"count": "Dataset"
						
					})
					DoublebarChartData.push({

						"Localization": obj,
						"Sequence frequency": data[obj]["dataset2_percentage"],
						"Sequences": "Dataset 2"
						//"count": "Dataset"
						
					})
			};


			var svg = dimple.newSvg("#chartStage", 1200, 600);		
			var myChart = new dimple.chart(svg, DoublebarChartData);

			var x = myChart.addCategoryAxis("x", ["Localization", "Sequences"]);
			var y = myChart.addMeasureAxis("y",  "Sequence frequency");

			var s = myChart.addSeries("Sequences", dimple.plot.bar);

			myLegend = myChart.addLegend(200, 10, 510, 20, "right");


			myChart.defaultColors = [
			    			new dimple.color("#0099FF"),
			    			new dimple.color("#FF6347"),
			    			new dimple.color("#FFFF00")
						]; 

			x.fontFamily = "Monotype Corsiva";
			x.fontSize = 18;
			y.fontFamily = "Monotype Corsiva";
			y.fontSize = 18;
			myLegend.fontFamily = "Monotype Corsiva";
			myLegend.fontSize = 14;

			myChart.staggerDraw = true;
			myChart.ease = "bounce";
			myChart.draw(1000);
			y.tickFormat = ".d"; //for float number format

			x.titleShape.text("Subcellular localization classes");
			y.titleShape.text("Sequence frequency per localization class(%)");

    			/*s.shapes.each(function(d) {

				var key1 , key2 , id;

				if(d.key.includes("Dataset_")){key1 = "Dataset";}
				else{key1 = "Reference";}
				key2 = d.x;

				for (var i = 0 ; i < barChartData.length ; i++) {

					if(barChartData[i].Reference == key1 && barChartData[i].Localization == key2){id = i;}
				};
	            var shape = d3.select(this),

	            height = myChart.y + myChart.height - y._scale(d.height);

	            width = d.width;

	            svg.append("text")



	            .attr("x", parseFloat(shape.attr("x")) + parseFloat(shape.attr("width"))/2)
	            .attr("y", y._scale(d.height/2))
	            .style("text-anchor", "middle")
	            .style("font-size", "10px")
	            .style("font-family", "sans-serif")
	            .style("opacity", 0.7)
	            .text(d3.format("")(barChartData[id].da));

	          });*/
			};



		function stackedBarDrawing(data){

			var stackedChartData = [];

			for (var obj in data){
					stackedChartData.push({
						"Localization": obj,
						"Reliability": "Reliability Index [81..100]",
						"Value": data[obj]["reference_81_100_percentage"],
						"Sequences": "Reference",
						"Order": 1 
					})
					stackedChartData.push({
						"Localization": obj,
						"Reliability": "Reliability Index [81..100]",
						"Value": data[obj]["dataset1_81_100_percentage"],
						"Sequences": "Dataset 1",
						"Order": 1 
					})
					stackedChartData.push({
						"Localization": obj,
						"Reliability": "Reliability Index [81..100]",
						"Value": data[obj]["dataset2_81_100_percentage"],
						"Sequences": "Dataset 2",
						"Order": 1 
					})
					stackedChartData.push({
						"Localization": obj,
						"Reliability": "Reliability Index [41..80]",
						"Value": data[obj]["reference_41_80_percentage"],
						"Sequences": "Reference",
						"Order": 2 
					})
					stackedChartData.push({
						"Localization": obj,
						"Reliability": "Reliability Index [41..80]",
						"Value": data[obj]["dataset1_41_80_percentage"],
						"Sequences": "Dataset 1",
						"Order": 2 
					})
					stackedChartData.push({
						"Localization": obj,
						"Reliability": "Reliability Index [41..80]",
						"Value": data[obj]["dataset2_41_80_percentage"],
						"Sequences": "Dataset 2",
						"Order": 2 
					})
					stackedChartData.push({
						"Localization": obj,
						"Reliability": "Reliability Index [0..40]",
						"Value": data[obj]["reference_0_40_percentage"],
						"Sequences": "Reference",
						"Order": 3 
					})
					stackedChartData.push({
						"Localization": obj,
						"Reliability": "Reliability Index [0..40]",
						"Value": data[obj]["dataset1_0_40_percentage"],
						"Sequences": "Dataset 1",
						"Order": 3 
					})
					stackedChartData.push({
						"Localization": obj,
						"Reliability": "Reliability Index [0..40]",
						"Value": data[obj]["dataset2_0_40_percentage"],
						"Sequences": "Dataset 2",
						"Order": 3 
					})
			};
			
			var svg = dimple.newSvg("#chartStacked", 1200, 600);
				var myChart = new dimple.chart(svg, stackedChartData);

				var x = myChart.addCategoryAxis("x", ["Localization", "Sequences"]);

				var y = myChart.addMeasureAxis("y",  "Value");

				var s = myChart.addSeries( ["Order", "Reliability"], dimple.plot.bar);
				s.addOrderRule("Order");
				
				s.categoryFields = ["Reliability"];
				myLegend = myChart.addLegend(200, 10, 510, 20, "right");


				myChart.defaultColors = [
			    			new dimple.color("#0099FF"),
			    			new dimple.color("#FF6347"),
			    			new dimple.color("#FFFF00")
						];  


				x.fontFamily = "Monotype Corsiva";
				x.fontSize = 18;
				y.fontFamily = "Monotype Corsiva";
				y.fontSize = 18;
				myLegend.fontFamily = "Monotype Corsiva";
				myLegend.fontSize = 14;
				

				myChart.staggerDraw = true;
				myChart.ease = "bounce";
				myChart.draw(1000);
				y.tickFormat = ".d"; //for float number format

				x.titleShape.text(" ");
				y.titleShape.text("Sequence frequency per localization class and RI(%)");

				/*
				s.shapes.each(function(d) {
					
					var shape = d3.select(this);
					svg.append("text")
	                .attr("x", parseFloat(shape.attr("x")) + parseInt(shape.attr('width')) / 2)
	                .attr("y", y._scale(d.height/2))
	                .style("text-anchor", "middle")
	                .style("font-size", "10px")
	                .style("font-family", "sans-serif")
	                .style("opacity", 0.7)
	                .text(d.yValue);
		           });
*/
		}



		function pieBarDrawing(data){

			var pieChartData = [];

				for (var obj in data){

						pieChartData.push({

							"Type": obj,
							"Reference Sequences": data[obj]["reference_sequences"],
							"Dataset 1 Sequences": data[obj]["dataset1_sequences"],
							"Dataset 2 Sequences": data[obj]["dataset2_sequences"]
					
						})
				//}
				};

			var width = 600;
			var height = 500;


			var svg = dimple.newSvg("#chartPie", width, height);   
			//svg.Attr("preserveAspectRatio", "xMinYMin meet");
	        var myChart = new dimple.chart(svg, pieChartData);

	        svg.append("text")
	        		.attr("x", width/2)
    				.attr("y", 20)
	                .style("text-anchor", "middle")
	                .style("font-size", "14px")
	                .style("font-family", "Monotype Corsiva")
	                .text("Dataset 1");
		    
			var y = myChart.addMeasureAxis("p",  "Dataset 1 Sequences");
			myChart.addSeries( "Type", dimple.plot.pie);
			y.tickFormat = ".d";

			myLegend = myChart.addLegend(400, 20, 150, 300, "right");
		    


			myChart.defaultColors = [
		    			new dimple.color("#0099FF"),
		    			new dimple.color("#FF6347"),
		    			new dimple.color("#FFFF00")
						];

			myLegend.fontFamily = "Monotype Corsiva";
			myLegend.fontSize = 13;  

						

		    myChart.draw();

		    ////////////////////////////////////////////////////////////////////////////////////////


			var svg2 = dimple.newSvg("#chartPie", width, height);	    
	        var myChart2 = new dimple.chart(svg2, pieChartData);

	        svg2.append("text")
	        		.attr("x",  width/2)
    				.attr("y", 20)
	                .style("text-anchor", "middle")
	                .style("font-size", "14px")
	                .style("font-family", "Monotype Corsiva")
	                .text("Dataset 2");
		    
			var y2 = myChart2.addMeasureAxis("p",  "Dataset 2 Sequences");

			myChart2.addSeries( "Type", dimple.plot.pie);
			y2.tickFormat = ".d";

		    myLegend2 = myChart2.addLegend(400, 20, 150, 300, "right");
		    


			myChart2.defaultColors = [
		    			new dimple.color("#0099FF"),
		    			new dimple.color("#FF6347"),
		    			new dimple.color("#FFFF00")
						]; 

			myLegend2.fontFamily = "Monotype Corsiva";
			myLegend2.fontSize = 13; 


		    myChart2.draw();


			var svg3 = dimple.newSvg("#chartPie", width, height);	    
	        var myChart3 = new dimple.chart(svg3, pieChartData);

	        svg3.append("text")
	        		.attr("x",  width/2)
    				.attr("y", 20)
	                .style("text-anchor", "middle")
	                .style("font-size", "14px")
	                .style("font-family", "Monotype Corsiva")
	                .text("Reference");
		    
			var y3 = myChart3.addMeasureAxis("p",  "Reference Sequences");

			myChart3.addSeries( "Type", dimple.plot.pie);
			y3.tickFormat = ".d";

		    myLegend3 = myChart3.addLegend(400, 20, 150, 300, "right");
		    


			myChart3.defaultColors = [
		    			new dimple.color("#0099FF"),
		    			new dimple.color("#FF6347"),
		    			new dimple.color("#FFFF00")
						]; 

			myLegend3.fontFamily = "Monotype Corsiva";
			myLegend3.fontSize = 13; 

		    myChart3.draw();
		}


		function Disorder(data){

			var disorderData = [];

				for (var obj in data){
						disorderData.push({
							"Disordered Regions" : obj,
							"Sequences": "Reference",
							"Number of Sequences": data[obj]["reference_sequences"]
						})
						disorderData.push({
							"Disordered Regions" : obj,
							"Sequences": "Dataset 1",
							"Number of Sequences": data[obj]["dataset1_sequences"]
						})
						disorderData.push({
							"Disordered Regions" : obj,
							"Sequences": "Dataset 2",
							"Number of Sequences": data[obj]["dataset2_sequences"]
						})
				};

			var svg = dimple.newSvg("#mDisorder", 1200, 600);
      		var myChart = new dimple.chart(svg, disorderData);

      		var x = myChart.addCategoryAxis("x", "Disordered Regions");
      		var y = myChart.addMeasureAxis("y", "Number of Sequences");
      		var s = myChart.addSeries("Sequences", dimple.plot.line);

      		s.lineWeight = 3;
      		s.lineMarkers = true;
      		y.tickFormat = " ";
			x.addOrderRule("Disordered Regions");
			//x.titleShape.text("Subcellular localization classes");
			//y.titleShape.text("Sequence frequency per localization class(%)");

      		myLegend = myChart.addLegend(60, 10, 500, 20, "right");

      		
			myChart.defaultColors = [
			    			new dimple.color("#0099FF"),
			    			new dimple.color("#FF6347"),
			    			new dimple.color("#FFFF00")
						]; 

			x.fontFamily = "Monotype Corsiva";
			x.fontSize = 18;
			y.fontFamily = "Monotype Corsiva";
			y.fontSize = 18;
			myLegend.fontFamily = "Monotype Corsiva";
			myLegend.fontSize = 14;
      		
      		myChart.draw();

		}

		</script>
	</body>
</html>